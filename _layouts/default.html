<!DOCTYPE html>
<html>

  {% include head.html %}

  <body class="light serif loaded">

  {% include header.html %}

  <div id="container" class="container font-size4 content-width4">

    <div id="reader-header" class="header" style="display: block;">
      <a id="reader-domain" class="domain" href="https://tabreturn.github.io">tabreturn.github.io</a>
      <div class="domain-border"></div>
      <h1 id="reader-title">A Blog Website Based on Reader View</h1>
      <div id="reader-credits" class="credits"></div>
    </div>

    <div class="content">
      <div id="moz-reader-content" class="line-height5" style="display: block;">
        <p>
          <a href="https://support.mozilla.org/en-US/kb/firefox-reader-view-clutter-free-web-pages">Reader View</a> is a Firefox feature that strips away clutter like buttons, ads and background images, and changes the page's text size, contrast and layout for better readability. Reader View settings are easily customizable to fit your reading preferences.
        </p>
        <p>
          It's how I (and many others?) prefer to read blogs and articles, so I reckon it must be the perfect format for this site!
        </p>
        <h2>Under Construction &hellip;</h2>
        <p>
          There's plenty of good content to come ... for now, though, here's a variable and a cat:
        </p>
        <pre>var x = 1;</pre>
        <figure>
          <img src="https://www.royalcanin.com/~/media/Royal-Canin/Product-Categories/cat-adult-landing-hero.ashx" />
          <figcaption>cat</figcaption>
        </figure>
      </div>

      <section id="isso-thread"></section>

    </div>

  </div>

  <ul id="reader-toolbar" class="toolbar">
    <li><button id="close-button" class="button close-button" title="Close Reader View"></button></li>
    <ul id="style-dropdown" class="dropdown">
      <li><button class="dropdown-toggle button style-button" title="Type controls"></button></li>
      <li id="reader-popup" class="dropdown-popup" style="top: 48px;">
        <div id="font-type-buttons"><button class="sans-serif-button"><div class="name">Aa</div><div class="description">Sans-serif</div></button><button class="serif-button selected"><div class="name">Aa</div><div class="description">Serif</div></button></div>
        <hr>
        <div id="font-size-buttons">
          <button id="font-size-minus" class="minus-button">
          </button><button id="font-size-sample">Aa</button><button id="font-size-plus" class="plus-button">
        </button></div>
        <hr>
        <div id="content-width-buttons">
          <button id="content-width-minus" class="content-width-minus-button">
          </button><button id="content-width-plus" class="content-width-plus-button">
        </button></div>
        <hr>
        <div id="line-height-buttons">
          <button id="line-height-minus" class="line-height-minus-button">
          </button><button id="line-height-plus" class="line-height-plus-button">
        </button></div>
        <hr>
        <div id="color-scheme-buttons"><button class="light-button selected"><div class="name">Light</div></button><button class="dark-button"><div class="name">Dark</div></button><button class="sepia-button"><div class="name">Sepia</div></button></div>
        <div class="dropdown-arrow">
      </div></li>
    </ul>
  </ul>

  {% include footer.html %}

  </body>

</html>

<script>

function typeControls() {

  // local storage:

  console.log(localStorage);

  function getLSValue(value) {
    if (localStorage[value])
      return parseInt(localStorage[value]);
    else
      return 4;
  }

  // reader popup:

  var reader_popup_visible = false;
  var reader_popup = document.getElementById('reader-popup');

  document.querySelector('.dropdown-toggle').addEventListener('click', function(){
    if (!reader_popup_visible)
      reader_popup.style.visibility = 'visible';
    else
      reader_popup.style.visibility = 'hidden';
    reader_popup_visible = !reader_popup_visible;
  });

  window.addEventListener('click', function(e) {
    parent_parent_id = null;

    try {
      parent_parent_id = e.target.parentElement.parentElement.id;
    } catch (e) {

    } finally {
      if (parent_parent_id!=='reader-popup' && parent_parent_id!=='style-dropdown' && reader_popup_visible) {
        reader_popup.style.visibility = 'hidden';
        reader_popup_visible = !reader_popup_visible;
      }
    }
  });

  // font family:

  function fontFamilySelect(selected, font) {
    document.querySelector('#font-type-buttons .sans-serif-button').classList.remove('selected');
    document.querySelector('#font-type-buttons .serif-button').classList.remove('selected');
    var body = document.getElementsByTagName('body')[0].classList;
    body.remove('sans-serif');
    body.remove('serif');
    body.add(font);
    selected.classList.add('selected');
  }

  document.querySelector('#font-type-buttons .sans-serif-button').addEventListener('click', function(){
    fontFamilySelect(this, 'sans-serif');
  });
  document.querySelector('#font-type-buttons .serif-button').addEventListener('click', function(){
    fontFamilySelect(this, 'serif');
  });

  // font size & content width & line height:

  fcl = {
    current_font_size: getLSValue('current_font_size'),
    current_content_width: getLSValue('current_content_width'),
    current_line_height: getLSValue('current_line_height')
  }

  function fclAdjust(increment, container_id, class_name, value_holder) {
    var container = document.getElementById(container_id);
    for (var i=1; i<=9; i++) {
      container.classList.remove(class_name+i);
    }
    fcl[value_holder] += increment;
    localStorage[value_holder] = fcl[value_holder];
    container.classList.add(class_name+fcl[value_holder]);
  }

  function fclSelect(increment, container_id, class_name, value_holder) {
    if (increment === 0)
      fclAdjust(increment, container_id, class_name, value_holder);
    else if (fcl[value_holder]>1 && fcl[value_holder]<9)
      fclAdjust(increment, container_id, class_name, value_holder);
    else if (fcl[value_holder]===9 && increment<0)
      fclAdjust(increment, container_id, class_name, value_holder);
    else if (fcl[value_holder]===1 && increment>0)
      fclAdjust(increment, container_id, class_name, value_holder);
  }

  fclSelect(0, 'container', 'font-size', 'current_font_size');
  fclSelect(0, 'container', 'content-width', 'current_content_width');
  fclSelect(0, 'container', 'line-height', 'current_line_height');

  document.querySelector('#font-size-buttons .minus-button').addEventListener('click', function(){
    fclSelect(-1, 'container', 'font-size', 'current_font_size');
  });
  document.querySelector('#font-size-buttons .plus-button').addEventListener('click', function(){
    fclSelect(+1, 'container', 'font-size', 'current_font_size');
  });
  document.querySelector('#content-width-buttons .content-width-minus-button').addEventListener('click', function(){
    fclSelect(-1, 'container', 'content-width', 'current_content_width');
  });
  document.querySelector('#content-width-buttons .content-width-plus-button').addEventListener('click', function(){
    fclSelect(+1, 'container', 'content-width', 'current_content_width');
  });
  document.querySelector('#line-height-buttons .line-height-minus-button').addEventListener('click', function(){
    fclSelect(-1, 'moz-reader-content', 'line-height', 'current_line_height');
  });
  document.querySelector('#line-height-buttons .line-height-plus-button').addEventListener('click', function(){
    fclSelect(+1, 'moz-reader-content', 'line-height', 'current_line_height');
  });

  // color schemes:

  function colorSchemeSelect(selected, scheme) {
    document.querySelector('#color-scheme-buttons .light-button').classList.remove('selected');
    document.querySelector('#color-scheme-buttons .dark-button').classList.remove('selected');
    document.querySelector('#color-scheme-buttons .sepia-button').classList.remove('selected');
    var body = document.getElementsByTagName('body')[0].classList;
    body.remove('light');
    body.remove('dark');
    body.remove('sepia');
    body.add(scheme);
    selected.classList.add('selected');
  }

  document.querySelector('#color-scheme-buttons .light-button').addEventListener('click', function(){
    colorSchemeSelect(this, 'light');
  });
  document.querySelector('#color-scheme-buttons .dark-button').addEventListener('click', function(){
    colorSchemeSelect(this, 'dark');
  });
  document.querySelector('#color-scheme-buttons .sepia-button').addEventListener('click', function(){
    colorSchemeSelect(this, 'sepia');
  });

}

typeControls();

</script>

<style>

/* reader toolbar fixes: */

#reader-toolbar {
  border-radius: 0;
}

#reader-toolbar li:first-child {
  margin: 0;
  padding: 0;
}

#reader-toolbar li button {
  border-right: none;
}

</style>

<script data-isso="https://secure.tabreturn.com/" src="https://secure.tabreturn.com/js/embed.min.js"></script>
